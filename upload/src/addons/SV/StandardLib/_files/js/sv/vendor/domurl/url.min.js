/*
 Lightweight URL manipulation with JavaScript
 This library is independent of any other libraries and has pretty simple
 interface and lightweight code-base.
 Some ideas of query string parsing had been taken from Jan Wolter
 @see http://unixpapa.com/js/querystring.html

 @license MIT
 @author Mykhailo Stadnyk <mikhus@gmail.com>
*/
(function(l){function p(){return m?(n||(n="file://"+(process.platform.match(w)?"/":"")+q("fs").realpathSync(".")),n):document.location.href}function g(a){return encodeURIComponent(a).replace(x,"%27")}function k(a){a=a.replace(r," ");a=a.replace(y,function(d,b,c,e){b=parseInt(b,16)-224;c=parseInt(c,16)-128;if(0===b&&32>c)return d;e=parseInt(e,16)-128;e=(b<<12)+(c<<6)+e;return 65535<e?d:String.fromCharCode(e)});a=a.replace(z,function(d,b,c){b=parseInt(b,16)-192;if(2>b)return d;d=parseInt(c,16)-128;
return String.fromCharCode((b<<6)+d)});return a.replace(A,function(d,b){return String.fromCharCode(parseInt(b,16))})}function t(a){a=a.split("&");for(var d=0,b=a.length;d<b;d++){var c=a[d].split("="),e=decodeURIComponent(c[0].replace(r," "));e&&(c=void 0!==c[1]?k(c[1]):null,void 0===this[e]?this[e]=c:(this[e]instanceof Array||(this[e]=[this[e]]),this[e].push(c)))}}function h(a,d){d=!d;var b;a||(a=p());if(m)var c=q("url").parse(a);else c=document.createElement("a"),c.href=a;var e=a;var f={path:!0,
query:!0,hash:!0};e&&B.test(e)&&(f.protocol=!0,f.host=!0,C.test(e)&&(f.port=!0),u.test(e)&&(f.user=!0,f.pass=!0));e=a.match(u)||[];for(b in v)this[b]=f[b]?c[v[b]]||"":"";this.protocol=this.protocol.replace(D,"");this.query=this.query.replace(E,"");this.hash=k(this.hash.replace(F,""));this.user=k(e[1]||"");this.pass=k(e[2]||"");this.port=G[this.protocol]==this.port||0==this.port?"":this.port;!f.protocol&&H.test(a.charAt(0))&&(this.path=a.split("?")[0].split("#")[0]);if(!f.protocol&&d){d=new h(p().match(I)[0]);
c=d.path.split("/");f=this.path.split("/");e=["protocol","user","pass","host","port"];var J=e.length;c.pop();for(b=0;b<J;b++)this[e[b]]=d[e[b]];for(;".."===f[0];)c.pop(),f.shift();this.path=("/"!==a.charAt(0)?c.join("/"):"")+"/"+f.join("/")}this.path=this.path.replace(K,"/");this.paths(this.paths());this.query=new t(this.query)}var B=/^[a-z]+:/,C=/[-a-z0-9]+(\.[-a-z0-9])*:\d+/i,u=/\/\/(.*?)(?::(.*?))?@/,w=/^win/i,D=/:$/,E=/^\?/,F=/^#/,I=/(.*\/)/,K=/^\/{2,}/,x=/'/g,y=/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,
z=/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,A=/%([0-7][0-9a-f])/gi,r=/\+/g,L=/^\w:$/,H=/[^/#?]/,m="undefined"===typeof window&&"undefined"!==typeof global&&"function"===typeof require,q=m?l.require:null,v={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},G={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443},n;t.prototype.toString=function(){var a="",d,b;for(d in this){var c=this[d];if(!(c instanceof Function||void 0===c))if(c instanceof Array){var e=c.length;if(e)for(b=
0;b<e;b++){var f=c[b];void 0!==f&&(a+=a?"&":"",a+=g(d)+(null===f?"":"="+g(f)))}else a+=(a?"&":"")+g(d)+"="}else a+=a?"&":"",a+=g(d)+(null===c?"":"="+g(c))}return a};h.prototype.clearQuery=function(){for(var a in this.query)this.query[a]instanceof Function||delete this.query[a];return this};h.prototype.queryLength=function(){var a=0,d;for(d in this.query)this.query[d]instanceof Function||a++;return a};h.prototype.isEmptyQuery=function(){return 0===this.queryLength()};h.prototype.paths=function(a){var d=
"",b=0,c;if(a&&a.length&&a+""!==a){this.isAbsolute()&&(d="/");for(c=a.length;b<c;b++)a[b]=!b&&L.test(a[b])?a[b]:g(a[b]);this.path=d+a.join("/")}a=("/"===this.path.charAt(0)?this.path.slice(1):this.path).split("/");b=0;for(c=a.length;b<c;b++)a[b]=k(a[b]);return a};h.prototype.encode=g;h.prototype.decode=k;h.prototype.isAbsolute=function(){return this.protocol||"/"===this.path.charAt(0)};h.prototype.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&g(this.user)+(this.pass&&
":"+g(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+g(this.hash))};l[l.exports?"exports":"Url"]=h})("undefined"!==typeof module&&module.exports?module:window);
